[Unit]
Description=DNS Failover Agent
Documentation=https://github.com/clash-version/n8n-agent
After=network-online.target
Wants=network-online.target

[Service]
Type=simple
User=root
Group=root
ExecStart=/usr/local/bin/dnsfailover monitor
Restart=always
RestartSec=10
StandardOutput=journal
StandardError=journal

# 工作目录
WorkingDirectory=/etc/dnsfailover

# 环境变量
Environment="CONFIG_PATH=/etc/dnsfailover/config.json"

# 安全选项
NoNewPrivileges=true
PrivateTmp=true
ProtectSystem=strict
ProtectHome=true
ReadWritePaths=/etc/dnsfailover /var/log/dnsfailover

# 资源限制
LimitNOFILE=65536
LimitNPROC=512

[Install]
WantedBy=multi-user.target
